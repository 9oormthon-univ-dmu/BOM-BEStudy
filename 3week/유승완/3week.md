# 3주차 : Spring Cloud MSA #1
<br/>

## 섹션1 : Microservice와 Spring Cloud (6번째 강의까지)
<br/>

## IT 시스템의 발전 과정

- 1960 ~ 1980 : 메인 프레임 시기 (Fragile - 깨지기 쉬운 시스템)
    
    소프트웨어 보단 하드웨어 사양이나 성격에 맞춰 서비스를 구축하던 시기. 하드웨어가 상당히 고가였기 때문에 서비스의 기능을 수정하거나 변경하기 상당히 어려웠음.
    
- 1990 ~ 2000 : 분산화 (Robust, Distributed)
    
    분산화 된 시스템 덕분에 서비스에 어느정도 불확실성의 변화가 발생한다 하더라도 안정성이 있고 성능이 높은 서비스를 유지할 수 있었음.
    
- 2010 ~ : 탄력적 (Resilient/Anti-Fragile, Cloud Native)
    
    로컬 환경에서 클라우드로 시스템이 옮겨 감으로써 확장성과 안정성이 더욱 강화 되었으며 지속적인 개선 및 변경사항이 생기더라도 시스템은 탄력적으로 운영할 수 있도록 구축되었음.
    
    Anti-Fragile 방식은 다른 개발 시스템이나 환경 보다는 시스템 변화가 적고 변화에 바로 적응할 수 있으며 무엇보다 비용 또한 저렴하다는 장점을 갖고 있다.
<br/>

## Anti-Fragile 방식의 4가지 특징

- Auto Scaling : 유지되어야 하는 최소의 인스턴스를 지정할 수 있고 사용량에 따라 자동으로 인스턴스 개수를 증가시킬 수 있음.
- Microservices : 기존의 시스템들이 하나의 거대한 형태로 구축되어 서비스되었다고 하면, 마이크로 서비스는 전체 서비스를 구축하고 있는 개별적인 모듈이나 기능을 독립적으로 개발하고 배포하고 운영할 수 있도록 세분화된 서비스라고 할 수 있다. 마이크로 서비스는 클라우드 네이티브 아키텍처, 클라우드 네이티브 애플리케이션의 핵심이다.
- Chaos engineering : 시스템이 급격하고 예측하지 못 한 상황이라도 견딜 수 있고 신뢰성을 쌓기 위해 운영 중인 소프트웨어 시스템에 실험하는 방법이라던가 규칙을 의미한다. 시스템의 변동이나 예견되거나 되지 않은 불확실성에 대해서도 안정적인 서비스를 제공할 수 있도록 구축되어야 한다는 것을 의미함.
- Continuous deployments : 마이크로 서비스를 구성하는 수백개인 서비스들을 일일히 테스트하고 빌드하고 배포하는 것은 매우 번거롭다. 이러한 과정을 자동화하는 시스템을 구축하고 하나의 작업에서 다른 작업으로 연계되는 과정을 파이프라인으로 연결 시켜놓게 되면 작은 변화뿐 아니라 전체적인 시스템 업그레이드 작업에서도 빠르게 적용할 수 있다.
<br/>

## 클라우드 네이티브 아키텍처란?

2010년대 이후부터 IT 시스템은 클라우드 네이티브 아키텍처 형태로 발전되어 왔다. 기존의 로컬 환경이나 사내에서 구축하고 운영하던 시스템을 클라우드 환경으로 전환하기 위해서는 아래와 같은 특징을 가져야 한다.

- 확장 가능한 아키텍처
    - 시스템의 수평적 확장/축소에 유연해야 함
    - 확장된 서버로 시스템의 부하를 분산하고, 가용성이 보장되어야 함
    - 시스템 또는 서비스 애플리케이션 단위의 패키지여야 함 (컨테이너 단위)
    - 모니터링 도구를 이용해 시스템의 상황, 리소스 사용량 등을 확인
- 탄력적 아키텍처
    - 서비스 생성 → 통합 → 배포 과정 자동화, 비즈니스 환경 변화에 대응 시간 단축 (CI/CD)
    - 애플리케이션을 구성하는 각 기능을 분리되고 독립된 서비스로 개발 (종속성 최소화)
- 장애 격리 (Fault Isolation)
    - 특정 서비스에 오류가 발생해도 다른 서비스에 영향을 미치지 않음 (독립된 서비스)
    - 장애 복구에 뛰어남
<br/>

## 클라우드 네이티브 애플리케이션이란?

클라우드 네이티브 아키텍처에 의해 설계되고 구현되는 애플리케이션을 `클라우드 네이티브 애플리케이션` 이라고 한다. 클라우드 네이티브 아키텍처의 특징을 가지며 아래와 같은 형태로 구현된다.

1. 마이크로 서비스로 개발
2. CI/CD 시스템에 의해 자동으로 통합되고 빌드, 테스트, 배포 과정을 거친다
    - Jenkins, Travis CI 같은 툴과 Git 같은 형상 관리 시스템을 연동해 지속적인 통합을 위한 파이프라인을 구성함
    - 지속적인 배포 - Continuous Delivery 혹은 Continuous Deployment
    - 카나리 배포와 블루/그린 배포
        
        전체 사용자의 95%는 이전 버전의 서비스, 5%는 최신 버전의 서비스를 이용하도록 하는 식의 배포 전략을 의미함
        
3. 마이크로 서비스에 문제가 발생했을 경우 바로 수정해서 다시 배포하는 과정을 반복한다 - 시스템이 종료될 때까지 반복 (DevOps)
    - Development와 Operations이 합쳐진 용어. 개발 조직과 운영 조직의 통합을 의미함
    - 이러한 통합으로 고객의 요구사항을 빠르게 반영하고 만족도 높은 결과물을 제시하는 것에 목적을 둠
    - 목적이 달성될 때까지 요구사항, 오류사항, 변경사항에 지속적으로 대처함
4. 컨테이너 가상화 기술 사용
    - 기존의 로컬 환경에서 운영되고 유지되던 시스템이 클라우드 환경으로 이전하면서 적은 비용으로 탄력성 있는 시스템을 구축하게 된 배경이 바로 컨테이너 가상화 기술이다
    - 기존의 하드웨어 가상화 또는 서버 가상화에 비해 적은 리소스를 사용할 수 있음
    - 독립적이고 가볍고 빠르다는 특징을 가짐
<br/>

## 클라우드 네이티브 아키텍처의 12(+3) Factors

클라우드 네이티브 애플리케이션을 개발하거나 운영함에 있어 고려해 봐야 할 12가지 항목

1. 베이스 코드
    
    자체 리포지토리에 저장된 각 마이크로 서비스에 대한 단일 코드 베이스를 뜻함. 형상관리를 위해 코드를 한 곳에서 배포하도록 하는 것을 의미함.
    
2. 종속성 독립
    
    각 마이크로 서비스는 자체 종속성을 가져야 하고 전체 시스템에 영향을 주지 않은 상태에서 변경되고 내용을 수정할 수 있어야 함.
    
3. 설정 정보
    
    서비스의 설정 정보를 시스템 외부에서 구성 관리 툴을 통해 마이크로 서비스에 필요한 작업들을 제어해야 함.
    
4. 연결 가능한 보조 서비스
    
    DB, 캐시, 메시징 서비스, 브로커 같은 보조 서비스를 이용해 마이크로 서비스가 가져야 할 어떤 기능들을 추가로 지원할 수 있어야 함.
    
5. 빌드, 릴리즈, 실행 환경 각각 분리
    
    개발 서버에서 만들어진 이 코드를 나중에 배포하기 위해서는 실행 단계까지 옮기는 과정을 엄격하게 분리해야 한다. 이전 상태로 돌아가기 위한 롤백 기능을 지원해야 하며, CI/CD 시스템을 통해 자동화 된 시스템을 구축해야 함.
    
6. 무상태 프로세스
    
    각각의 마이크로 서비스는 실행 중인 다른 서비스와 분리된 채 자체 프로세스에서 운영될 수 있어야 함. (독립성과 비슷한 내용)
    
7. 포트 바인딩
    
    각각의 마이크로 서비스는 서로 다른 포트를 갖게 되며 다른 마이크로 서비스와는 격리되어야 함.
    
8. 동시성
    
    마이크로 서비스는 수 많은 서비스를 동일한 프로세스로 복사해서 확장해 나가게 된다. 부하 분산을 위해 동일한 서비스가 여러 인스턴스로 나눠서 서비스 되기 때문에 동시성을 갖춰야 한다.
    
9. 일회용성 (Disposability)
    
    서비스 인스턴스 자체가 삭제가 가능해야 된다는 의미. 유연한 확장/축소를 위해 언제든지 실행되고 종료될 수 있는 상태여야 한다.
    
10. 개발 단계와 프로덕션 단계 분리
    
    애플리케이션의 배포, 테스트, 개발 과정에서 발생할 수 있는 차이를 최소화하여, 개발자가 운영 환경에서의 문제를 더 쉽게 예측하고 해결할 수 있도록 한다. 이를 통해 일관된 개발, 테스트, 운영 환경을 유지할 수 있으며, 최종적으로는 더 높은 품질의 소프트웨어를 제공할 수 있다.
    
11. 로깅 시스템
    
    마이크로 서비스에 의해 생성된 로그들을 집계하여 별도의 추가적인 서비스나 모니터링 툴을 통해 관리해야 한다.
    
12. 프로세스 관리
    
    현재 운영되고 있는 모든 마이크로 서비스들이 어떤 상태로 사용되고 있으며, 리소스가 어떻게 쓰이고 있는지에 대해 파악하기 위한 적절한 관리 도구가 필요함. 데이터 수집, 분석 기능이 포함될 수 있음.
    
13. API first
    
    특정 마이크로 서비스에 접근하기 위해선 우선 하나의 API 서비스를 거쳐야 한다. API를 구축함에 있어서 사용자 측에서 어떤 형태로 쓸 것 인가를 고민해서 개발해야 함.
    
14. Telemetry
    
    모든 지표는 수치화되고 시각화되어 관리할 수 있어야 한다.
    
15. Authentication and Authorization
    
    마이크로 서비스가 분리되어 있다 하더라도 서로간의 인증 방법을 명확히 구현해야 함. (보안)
<br/>    

## 마무리

졸업 작품 프로젝트의 CI/CD 파이프라인을 구축 하면서 공부한 내용들이 몇몇 등장해서 반가웠다. 새로 배우는 내용들이 더 많기 때문에 재미있지만, 실습을 해봐야 제대로 이해가 될 듯 하다. 로깅이나 모니터링은 아직 제대로 구현해본 적이 없어서 앞으로 좀 더 알아봐야겠다.
